%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Everything below can be freely edited.          % 
% Beware that it may break the compilation of     %
% the main demo file, though.                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%
% Debugging packages %
%%%%%%%%%%%%%%%%%%%%%%

% \usepackage{showframe} % show the page layout
\usepackage{layouts}   
% Allow to use 
% \printinunitsof{in}{\pagevalues}
% to "see" the margins.

% The following commands allows to "see" the font sizes.
% cf. https://tex.stackexchange.com/a/24600
% https://texfaq.org/FAQ-csname
\makeatletter
\newcommand\thefontsize[1]{\csname #1\endcsname #1 is equivalent to \f@size pt\par}
\makeatother

\newcommand{\getfontsize}{
    \thefontsize{tiny}
    \thefontsize{scriptsize}
    \thefontsize{footnotesize}
    \thefontsize{small}
    \thefontsize{normalsize}
    \thefontsize{large}
    \thefontsize{Large}
    \thefontsize{LARGE}
    \thefontsize{huge}
    \thefontsize{Huge}
    \normalsize
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Emoji support for latex %
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[verbose]{newunicodechar}

% List of symbols supported by Symbola at
% https://www.fileformat.info/info/unicode/font/symbola/list.htm
\defaultfontfeatures[Symbola]{Path=fonts/, Extension={.ttf}, UprightFont={*}}
\newfontfamily\sym{Symbola}
\DeclareTextFontCommand{\symb}{\sym}

% The following unicode symbols are rendered in the 
% symbola font, as they do not exist in the main
% font of the template:
\newunicodechar{üîí}{\symb üîí} % U+1F512, "LOCK"
\newunicodechar{‚úò}{\symb ‚úò} % U+2718,  "HEAVY BALLOT X"
\newunicodechar{‚ö†}{\symb ‚ö†} % U+26A0,  "WARNING SIGN"
\newunicodechar{‚ùì}{\symb ‚ùì} % U+2753, "BLACK QUESTION MARK ORNAMENT"
\newunicodechar{üîú}{\symb üîú} % U+1F51C, "SOON WITH RIGHTWARDS ARROW ABOVE"
\newunicodechar{‚Ñï}{\symb ‚Ñï} % U+2115,  "DOUBLE-STRUCK CAPITAL N"
\newunicodechar{‚Ñ§}{\symb ‚Ñ§} % U+2124,  "DOUBLE-STRUCK CAPITAL Z"
\newunicodechar{‚úî}{\symb ‚úî} % U+2714,  "HEAVY CHECK MARK"
% More symbols for new lines: https://stackoverflow.com/a/18931703
\newunicodechar{‚Üµ}{\symb ‚Üµ} % U+21B5,  "DOWNWARDS ARROW WITH CORNER LEFTWARDS"
\newunicodechar{‚Ü≤}{\symb ‚Ü≤} % U+21B2,  "DOWNWARDS ARROW WITH TIP LEFTWARDS"
\newunicodechar{üõ°}{\symb üõ°} % U+1F6E1, "SHIELD"
\newunicodechar{‚Ñù}{\symb ‚Ñù} % U+211D,  "Double-Struck Capital R"
\newunicodechar{‚ñ°}{\symb ‚ñ°} % U+25A1,  "White square"

% Note that you can also define unicode characters
% to be interpreted as latex commands, following
% https://tex.stackexchange.com/a/522961 :

\newunicodechar{‚Üî}{\ensuremath{\leftrightarrow}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% Colors                           %
% https://brand.augusta.edu/color/ %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{xcolor}
% Those are the "official" AU color, but we are assuming black-and-white printing.
\definecolor{augustablue}{HTML}{002f55} % Used for "external" links.
\definecolor{augustagrey}{HTML}{A5ACAF} % Used for "internal" links.

% Non-colored links, with underline, cf. https://tex.stackexchange.com/a/26085
% This allow the links to be visually present only if the document is viewed on a screen.
% Colored distribution inspired by https://tex.stackexchange.com/a/526148

% Setup new colors
\AtEndPreamble{
    \hypersetup{
        pdfborder={0 0 1},
        pdfborderstyle={/S/U/W 1}, % border style will be underline of width 1pt
        linkbordercolor=augustagrey,
        citebordercolor=augustagrey,
        filebordercolor=augustablue,
        urlbordercolor=augustablue,
        menubordercolor=augustagrey,
        runbordercolor=augustablue
    }
}

%%%%%%%%%%%%%%%%%%%%%
% Code Presentation %
%%%%%%%%%%%%%%%%%%%%%

% We make listings be a bit more pretty,
% cf. https://tex.stackexchange.com/a/272133

\lstset{
    % Space skipped before code block    
    % Default style fors listings
    basicstyle=\small\ttfamily\linespread{4},
    % flexible columns
    columns=[l]flexible,
    commentstyle=\color[rgb]{0.127,0.427,0.514}\ttfamily\itshape,
    escapechar=@,
    % Enables ASCII chars 128 to 255
    extendedchars=true,
    % Frame only at the top and bottom
    frame=tb,
    % Coloring schemes
    identifierstyle=\color{black},
    keywordstyle=\color[HTML]{228B22}\bfseries,
    ndkeywordstyle=\color[HTML]{228B22}\bfseries,
    % Style for strings
    stringstyle=\ttfamily,
    % Style for comments
    commentstyle={\ttfamily\color[HTML]{228B22}},
    % Line numbers at the left, and font left by default
    numbers=left,
    % numberstyle=\tiny, % uncomment if you want smaller line numbers.
    % Automatic breaking of long lines
    breaklines=true,
    % Add the "‚Ü≤" symbol whenever a line is broken.
    % The "‚Ü≤" symbol is declared as a unicode symbol
    % in the other header file (head_a.tex).
    prebreak=\raisebox{0ex}[0ex][0ex]{‚Ü≤},
    % How strings are formatted, and style of quote sign.
    stringstyle=\color[rgb]{0.639,0.082,0.082}\ttfamily,
    upquote=true,
    % Anything betweeen $ does not become LaTeX math mode
    mathescape=false,
    % Spaces are not displayed as a special character
    showstringspaces=false,
    % Size of tabulations
    tabsize=3,
    % Case sensitivity
    sensitive=true,
    % Position of captions is bottom
    captionpos=b,
    % We reduce the space between the caption and the code.
    % This seems to come from a strange interaction between 
    % the listings and caption packages,
    % cf. https://tex.stackexchange.com/a/365260/
    abovecaptionskip=-30pt,
    % Floating option
    float=H,
    % We increment the space before and after the listings.
    aboveskip=2em,
    belowskip=2em, 
}

\lstset{literate=%
   *{0}{{{\color{darkgray}0}}}1
    {1}{{{\color{darkgray}1}}}1
    {2}{{{\color{darkgray}2}}}1
    {3}{{{\color{darkgray}3}}}1
    {4}{{{\color{darkgray}4}}}1
    {5}{{{\color{darkgray}5}}}1
    {6}{{{\color{darkgray}6}}}1
    {7}{{{\color{darkgray}7}}}1
    {8}{{{\color{darkgray}8}}}1
    {9}{{{\color{darkgray}9}}}1
} 

% We define a style for the Coq programming language
% https://tex.stackexchange.com/a/620012/
% lstlisting coq style (inspired from a file of Assia Mahboubi)

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{ltblue}{rgb}{0,0.4,0.4}
\definecolor{dkviolet}{rgb}{0.3,0,0.5}

\lstdefinelanguage{coq}{ 
    % Comments may or not include Latex commands
    texcl=false, 
    % Vernacular commands
    morekeywords=[1]{Section, Module, End, Require, Import, Export,
        Variable, Variables, Parameter, Parameters, Axiom, Hypothesis,
        Hypotheses, Notation, Local, Tactic, Reserved, Scope, Open, Close,
        Bind, Delimit, Definition, Let, Ltac, Fixpoint, CoFixpoint, Add,
        Morphism, Relation, Implicit, Arguments, Unset, Contextual,
        Strict, Prenex, Implicits, Inductive, CoInductive, Record,
        Structure, Canonical, Coercion, Context, Class, Global, Instance,
        Program, Infix, Theorem, Lemma, Corollary, Proposition, Fact,
        Remark, Example, Proof, Goal, Save, Qed, Defined, Hint, Resolve,
        Rewrite, View, Search, Show, Print, Printing, All, Eval, Check,
        Projections, inside, outside, Def},
    % Gallina
    morekeywords=[2]{forall, exists, exists2, fun, fix, cofix, struct,
        match, with, end, as, in, return, let, if, is, then, else, for, of,
        nosimpl, when},
    % Sorts
    morekeywords=[3]{Type, Prop, Set, true, false, option},
    % Various tactics, some are std Coq subsumed by ssr, for the manual purpose
    morekeywords=[4]{pose, set, move, case, elim, apply, clear, hnf,
        intro, intros, generalize, rename, pattern, after, destruct,
        induction, using, refine, inversion, injection, rewrite, congr,
        unlock, compute, ring, field, fourier, replace, fold, unfold,
        change, cutrewrite, simpl, have, suff, wlog, suffices, without,
        loss, nat_norm, assert, cut, trivial, revert, bool_congr, nat_congr,
        symmetry, transitivity, auto, split, left, right, autorewrite},
    % Terminators
    morekeywords=[5]{by, done, exact, reflexivity, tauto, romega, omega,
        assumption, solve, contradiction, discriminate},
    % Control
    morekeywords=[6]{do, last, first, try, idtac, repeat},
    % Comments delimiters, we do turn this off for the manual
    morecomment=[s]{(*}{*)},
    % String delimiters
    morestring=[b]",
    morestring=[d],
    % Style for (listings') identifiers
    identifierstyle={\ttfamily\color{black}},
    % Style for declaration keywords
    keywordstyle=[1]{\ttfamily\color{dkviolet}},
    % Style for gallina keywords
    keywordstyle=[2]{\ttfamily\color{dkgreen}},
    % Style for sorts keywords
    keywordstyle=[3]{\ttfamily\color{ltblue}},
    % Style for tactics keywords
    keywordstyle=[4]{\ttfamily\color{dkblue}},
    % Style for terminators keywords
    keywordstyle=[5]{\ttfamily\color{dkred}},
    %Style for iterators
    % keywordstyle=[6]{\ttfamily\color{dkpink}},
    literate=
    {\\forall}{{\color{dkgreen}{$\forall\;$}}}1
    {\\exists}{{$\exists\;$}}1
    {<-}{{$\leftarrow\;$}}1
    {=>}{{$\Rightarrow\;$}}1
    {==}{{\code{==}\;}}1
    {==>}{{\code{==>}\;}}1
    %    {:>}{{\code{:>}\;}}1
    {->}{{$\rightarrow\;$}}1
    {<->}{{$\leftrightarrow\;$}}1
    {<==}{{$\leq\;$}}1
    {\#}{{$^\star$}}1 
    {\\o}{{$\circ\;$}}1 
    {\@}{{$\cdot$}}1 
    {\/\\}{{$\wedge\;$}}1
    {\\\/}{{$\vee\;$}}1
    {++}{{\code{++}}}1
    {~}{{\ }}1
    {\@\@}{{$@$}}1
    {\\mapsto}{{$\mapsto\;$}}1
    {\\hline}{{\rule{\linewidth}{0.5pt}}}1
    %
}[keywords,comments,strings]

%%%%%%%%%%%%%%%
% Derivations %
%%%%%%%%%%%%%%%

% We recommend using the more modern ebproof over
% the more "traditional" bussproofs,
\usepackage{ebproof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Nice frames, for the documents we will be including %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[breakable]{tcolorbox} % Will be used for frame around included documents.
% https://tex.stackexchange.com/a/66156
\DeclareRobustCommand\titleforcurrentframe{temp}  % Title for the current page of the frame.
% This macro is re-defined in \modifiedincludepdf
% and \modifiedincludetxt
\newcommand{\mybox}[1]{%
    \begin{tcolorbox}[
        colframe=augustablue,
        colback=white,
        width={\dimexpr\textwidth},
        breakable,
        adjusted title={\hypersetup{citecolor=white}\titleforcurrentframe}
    ]
    #1
    \end{tcolorbox}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Commands to include pdf %
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{pdfpages}
% https://tex.stackexchange.com/questions/198091/get-number-of-pages-of-external-pdf/198095#198095
\newcommand*{\numberofpages}[1]{%
    \the\XeTeXpdfpagecount"#1" %
}

% Counter to add label to individual pages of the pdf.
% https://tex.stackexchange.com/a/25113
\newcounter{currentpagecounter}
\newcounter{totaldocpages}
% Command to include pdf document.
% Usage:
% \modifiedincludepdf{options for includepdf}{label}{full path to the document}{title of the document}{"level" (e.g., section, subsection, etc.)}
\newcommand{\modifiedincludepdf}[6]{
    \let\fbox\mybox % includepsf, with the option "frame", use \fbox
    % to draw the frame. We change the command, to use
    % our custom frame, that uses tcolorbox.
    \setcounter{currentpagecounter}{0}
    \setcounter{totaldocpages}{\numberofpages{#3}}
    \renewcommand{\titleforcurrentframe}{#4 (p.\ \thecurrentpagecounter\ / \thetotaldocpages) \hfill #6} % #6 acts as a subtitle
    \includepdf[#1,%
    width=\textwidth,%
    pages=-,%
    frame,
    clip,
    pagecommand={
        \stepcounter{currentpagecounter} % We increment the counter for the number of pages.
        \label{#2.\thecurrentpagecounter}% We add a label of the form "label.pagenumber".
    },
    link = true,
    linkname = {#2},
    addtotoc={1, #5, 1, #4, #2} % We add an entry to the table of content.
    ]{#3}
}

%%%%%%%%%
% Misc. %
%%%%%%%%%

% To set maximum width and height, courtesy of https://github.com/jgm/pandoc-templates/blob/master/default.latex.orig
\makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
    \def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother

\usepackage{pdflscape}  % For sideways figures and landscape pages.
\usepackage{csquotes}   % For proper quotations.
\usepackage{mathtools}  % For math. environments
\usepackage{amsthm}     % For math. environments

% For the BibTex logo, courtesy of https://tex.stackexchange.com/a/198472
\def\BibTeX{\textrm{B\kern-.05em\textsc{i\kern-.025em b}\kern-.08em T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\newtheorem{theorem}{Theorem}
